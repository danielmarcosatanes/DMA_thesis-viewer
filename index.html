<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>DMA Thesis: 3D Molecule Viewer</title>
    <link rel="stylesheet" href="styles.css">
    <script type="text/javascript" src="JSmol.min.js"></script>
</head>
<body>
    <!-- Main Container with Sidebar and Content -->
    <div id="main-container">
        <!-- Sidebar Toggle Buttons -->
        <button id="sidebar-toggle" class="mobile-toggle" aria-label="Toggle sidebar">☰</button>
        <button id="collapse-btn" class="collapse-btn" aria-label="Collapse Sidebar">☰</button>

        <!-- Sidebar -->
        <div id="sidebar">
            <header>
                <h2>DMA Thesis</h2>
                <input type="text" id="sidebar-search" placeholder="Search..." onkeyup="searchMenu()">
            </header>

            <div id="menu">
                <a href="#" id="home-link" onclick="showHome(); setActiveLink('home-link')">Home</a>
                <a href="#" id="structures-link" onclick="toggleStructuresMenu(); setActiveLink('structures-link')">Structures</a>

                <div id="structures-menu" class="sidebar-section" style="display: none;">
                    <a href="#" onclick="showSection('section7.1'); setActiveLink('section7.1')">Structures section 7.1</a>
                    <div id="subsections7.1" class="subsections" style="display: none;">
                        <a href="#" onclick="showSubsection('subsection44aBipyIrBpin'); setActiveLink('subsection44aBipyIrBpin')">44a-Bipy-Ir(Bpin)</a>
                        <a href="#" onclick="showSubsection('subsection44aBipyIrBpin5'); setActiveLink('subsection44aBipyIrBpin5')">44a-Bipy-Ir(Bpin)5</a>
                    </div>
                    <a href="#" onclick="showSection('section7.2'); setActiveLink('section7.2')">Structures section 7.2</a>
                    <div id="subsections7.2" class="subsections" style="display: none;">
                        <a href="#" onclick="showSubsection('subsection44aBipyIrHBPin2'); setActiveLink('subsection44aBipyIrHBPin2')">44a-Bipy-Ir-H-Bpin2</a>
                    </div>
                    <a href="#" onclick="showSection('section7.3'); setActiveLink('section7.3')">Structures section 7.3</a>
                    <div id="subsections7.3" class="subsections" style="display: none;">
                        <a href="#" onclick="showSubsection('subsection44a'); setActiveLink('subsection44a')">44a</a>
                        <a href="#" onclick="showSubsection('subsection45a'); setActiveLink('subsection45a')">45a</a>
                    </div>
                </div>
            </div>

            <footer>2024 DMA Thesis Viewer. All rights reserved.</footer>
        </div>

        <!-- Main Content Area -->
        <div id="content">
            <div id="home-page" style="display: block;">
                <h1 id="home-header" style="color: #28528E;">DMA Thesis: 3D Molecule Viewer</h1>
                <p>Welcome to the DMA Thesis 3D Molecule Visualizer. Use the menu to navigate through various sections.</p>
            </div>
        </div>
    </div>

    <script>
        const Info = {
            width: 700,
            height: 400,
            j2sPath: "j2s",
            color: "white",
            use: "HTML5",
            disableJ2SLoadMonitor: true,
            disableInitialConsole: true
        };

        function loadJSmol(containerId, moleculeFile) {
            const jsmolApplet = Jmol.getApplet(containerId, Info);
            document.getElementById(containerId).innerHTML = Jmol.getAppletHtml(jsmolApplet);
            Jmol.script(jsmolApplet, `load 'molecules/${moleculeFile}';`);
        }

        function showHome() {
            displayOnly('home-page');
        }

        function toggleStructuresMenu() {
            toggleVisibility('structures-menu');
        }

        function showSection(sectionId) {
            displayOnly(sectionId);
            toggleVisibility(`subsections${sectionId.split('section')[1]}`, true);
        }
        
        function showSubsection(subsectionId) {
    // Hide all subsections
    var subsections = document.querySelectorAll('#content > div');
    subsections.forEach(function(subsection) {
        subsection.style.display = 'none';
    });

    // Show the selected subsection
    document.getElementById(subsectionId).style.display = 'block';

    // Define the mapping between subsectionId and the sidebar section to show
    const sectionMapping = {
        'subsection44aBipyIrBpin': 'section7.1',
        'subsection44aBipyIrBpin5': 'section7.1',
        'subsection44aBipyIrHBPin2': 'section7.2',
        'subsection44a': 'section7.3',
        'subsection45a': 'section7.3'
    };

    // Collapse all sidebar sections
    var sidebarSections = document.querySelectorAll('.sidebar-section');
    sidebarSections.forEach(function(section) {
        section.style.display = 'none';
    });

    // Show the active sidebar section based on the subsectionId
    const activeSectionId = sectionMapping[subsectionId];
    if (activeSectionId) {
        document.getElementById(activeSectionId).style.display = 'block';
    }

    // Molecule mapping with container IDs and log file names
    const molecules = {
        subsection44aBipyIrBpin: { container: 'jsmolContainer44aBipyIrBpin', file: '44a-Bipy-Ir(Bpin).log' },
        subsection44aBipyIrBpin5: { container: 'jsmolContainer44aBipyIrBpin5', file: '44a-Bipy-Ir(Bpin)5.log' },
        subsection44aBipyIrHBPin2: { container: 'jsmolContainer44aBipyIrHBPin2', file: '44a-Bipy-Ir-H-Bpin2.log' },
        subsection44a: { container: 'jsmolContainer44a', file: '44a.log' },
        subsection45a: { container: 'jsmolContainer45a', file: '45a.log' }
    };

    // Ensure the container exists before loading
    const molecule = molecules[subsectionId];
    if (molecule) {
        loadJSmol(molecule.container, molecule.file);
    }
}

        function searchMenu() {
            const query = document.getElementById('sidebar-search').value.toLowerCase();
            const menuItems = document.querySelectorAll('#menu a, .subsections a');
            menuItems.forEach(item => {
                if (item.textContent.toLowerCase().includes(query)) {
                    item.style.display = 'block';
                    item.closest('.sidebar-section').style.display = 'block';
                } else {
                    item.style.display = 'none';
                }
            });
        }

        function toggleVisibility(id, show = false) {
            const element = document.getElementById(id);
            element.style.display = show ? 'block' : (element.style.display === 'block' ? 'none' : 'block');
        }

        function displayOnly(sectionId) {
            document.querySelectorAll('#content > div').forEach(section => {
                section.style.display = section.id === sectionId ? 'block' : 'none';
            });
        }

        document.querySelector('#sidebar-toggle').addEventListener('click', () => {
            document.getElementById('sidebar').classList.toggle('show');
        });

        document.querySelector('#collapse-btn').addEventListener('click', () => {
            document.getElementById('sidebar').classList.toggle('collapsed');
        });
    </script>
</body>
</html>
