<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DMA Thesis Viewer | 3D Structures</title>
    <link rel="stylesheet" href="styles.css">
    <script type="text/javascript" src="JSmol.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&family=Lora:ital,wght@0,400;0,700;1,400&display=swap" rel="stylesheet">
</head>
<body>

    <button id="sidebar-toggle" class="mobile-toggle" onclick="toggleSidebar()">‚ò∞ Menu</button>

    <div id="main-container">
        <nav id="sidebar">
            <header>
                <h1>DMA Thesis</h1>
                <p class="subtitle">3D Molecule Viewer</p>
                <input type="text" id="sidebar-search" placeholder="Search structures..." onkeyup="searchMenu()">
            </header>
            <div id="menu">
                <a href="#" id="home-link" class="active" onclick="showHomePage(); setActiveLink('home-link')">Home Overview</a>
                <!-- El √°rbol se genera aqu√≠ -->
            </div>
            <footer>
                <a href="https://daniel-marcosatanes.github.io/" target="_blank">‚Üê Back to Portfolio</a>
            </footer>
        </nav>

        <main id="content">
            <div id="dynamic-content" class="container-pro">
                <!-- Se inyecta por JS -->
            </div>
        </main>
    </div>

<script>
    // --- OBJETO DE DATOS COMPLETO (Sincronizado con tu √°rbol de archivos) ---
      const structureData = {
        "Structures": {
        "Structures section 7.1": [
            "4-m-bipy-OA-TS-Ir(R-H)(Bpin)3.log",
            "4-p-bipy-OA-TS-Ir(R-H)(Bpin)3.log",
            "5-OR-bipy-OA-TS-Ir(R-H)(Bpin)3.log",
            "5-m-phen-OA-TS-Ir(R-H)(Bpin)3.log",
            "5-p-phen-OA-TS-Ir(R-H)(Bpin)3.log",
            "bipy-OA-TS-Ir(R-H)(Bpin)3.log"
        ],
        "Structures section 7.2": {
            "3-CF3-Bipy": {
                "Meta": ["3-CF3-Bipy_TS_m-31.log"],
                "Ortho": ["3-CF3-Bipy_TS_o-2.log"],
                "Para": ["3-CF3-Bipy_TS_p-1.log"]
            },
            "4-CF3-Bipy": {
                "Meta": ["4-CF3-Bipy_TS_m-8.log"],
                "Ortho": ["4-CF3-Bipy_TS_o-3.log"],
                "Para": ["4-CF3-Bipy_TS_p-3.log"]
            },
            "5-CF3-Bipy": {
                "Meta": ["5-CF3-Bipy_TS_m-5.log"],
                "Ortho": ["5-CF3-Bipy_TSOA_o-1.log"],
                "Para": ["5-CF3-Bipy_TSOA_p-1.log"]
            },
            "Bipy": {
                "Meta": ["Bipy_TS_m-3.log"],
                "Ortho": ["Bipy_TS_o-1.log"],
                "Para": ["Bipy_TS_p-1.log"]
            }
        },
        "Structures section 7.3": {
          "Borylation of 44a": {
              "5-CF3-Bipy": {
                  "Ir(Bpin)": ["L27-Ir(Bpin).log"],
                  "Ir(Bpin)3": ["L27-Ir(Bpin)3.log"],
                  "Ir(Bpin)5": ["L27-Ir(Bpin)5.log"],
                  "Ir(H)(Bpin)2": ["L27-Ir(H)(Bpin)2.log"],
                  "Isom-H": {
                      "RE-TS-isoH-Ir(Bpin)3(R)(H)": ["L27-RE-TS-isoH-Ir(Bpin)3(R)(H).log"],
                      "isoH-Ir(Bpin)3(R)(H)": ["L27-isoH-Ir(Bpin)3(R)(H).log"],
                      "isomH-TS-Ir(Bpin)3(R)(H)": ["L27-isomH-TS-Ir(Bpin)3(R)(H).log"],
                      "œÉ-isoH-(R-Bpin)Ir(Bpin)2(H)": ["L27-œÉ-isoH-(R-Bpin)Ir(Bpin)2(H).log"]
                  },
                  "Isom-S": {
                      "RE-TS-isoS-Ir(Bpin)3(R)(H)": ["L27-RE-TS-isoS-Ir(Bpin)3(R)(H).log"],
                      "isoS-Ir(Bpin)3(R)(H)": ["L27-isoS-Ir(Bpin)3(R)(H).log"],
                      "isomS-TS-Ir(Bpin)3(R)(H)": ["L27-isomS-TS-Ir(Bpin)3(R)(H).log"],
                      "œÉ-isoS-(R-Bpin)Ir(Bpin)2(H)": ["L27-œÉ-isoS-(R-Bpin)Ir(Bpin)2(H).log"]
                  },
                  "OA": {
                      "Ir(Bpin)3(R)(H)": ["L27-Ir(Bpin)3(R)(H).log"],
                      "OA-TS-Ir(R-H)(Bpin)3": ["L27-OA-TS-Ir(R-H)(Bpin)3.log"],
                      "œÉ-(R-H)Ir(Bpin)3": ["L27-œÉ-(R-H)Ir(Bpin)3.log"]
                  },
                  "RE": {
                      "RE-TS-Ir(Bpin)3(R)(H)": ["L27-RE-TS-Ir(Bpin)3(R)(H).log"],
                      "œÉ-iso-(R-Bpin)Ir(Bpin)2(H)": ["L27-œÉ-iso-(R-Bpin)Ir(Bpin)2(H).log"]
                  }
              },
              "Bipy": {
                  "Ir(Bpin)": ["Bipy-Ir(Bpin).log"],
                  "Ir(Bpin)3": ["Bipy-Ir(Bpin)3.log"],
                  "Ir(Bpin)5": ["Bipy-Ir(Bpin)5.log"],
                  "Ir(H)(Bpin)2": ["Bipy-Ir(H)(Bpin)2.log"],
                  "Isom-H": {
                      "RE-TS-isoH-Ir(Bpin)3(R)(H)": ["Bipy-RE-TS-isoH-Ir(Bpin)3(R)(H).log"],
                      "isoH-Ir(Bpin)3(R)(H)": ["Bipy-isoH-Ir(Bpin)3(R)(H).log"],
                      "isomH-TS-Ir(Bpin)3(R)(H)": ["Bipy-isomH-TS-Ir(Bpin)3(R)(H).log"],
                      "œÉ-isoH-(R-Bpin)Ir(Bpin)2(H)": ["Bipy-œÉ-isoH-(R-Bpin)Ir(Bpin)2(H).log"]
                  },
                  "Isom-S": {
                      "RE-TS-isoS-Ir(Bpin)3(R)(H)": ["Bipy-RE-TS-isoS-Ir(Bpin)3(R)(H).log"],
                      "isoS-Ir(Bpin)3(R)(H)": ["Bipy-isoS-Ir(Bpin)3(R)(H).log"],
                      "isomS-TS-Ir(Bpin)3(R)(H)": ["Bipy-isomS-TS-Ir(Bpin)3(R)(H).log"],
                      "œÉ-isoS-(R-Bpin)Ir(Bpin)2(H)": ["Bipy-œÉ-isoS-(R-Bpin)Ir(Bpin)2(H).log"]
                  },
                  "OA": {
                      "Ir(Bpin)3(R)(H)": ["Bipy-Ir(Bpin)3(R)(H).log"],
                      "OA-TS-Ir(R-H)(Bpin)3": ["Bipy-OA-TS-Ir(R-H)(Bpin)3.log"],
                      "œÉ-(R-H)Ir(Bpin)3": ["Bipy-œÉ-(R-H)Ir(Bpin)3.log"]
                  },
                  "RE": {
                      "RE-TS-Ir(Bpin)3(R)(H)": ["Bipy-RE-TS-Ir(Bpin)3(R)(H).log"],
                      "œÉ-iso-(R-Bpin)Ir(Bpin)2(H)": ["Bipy-œÉ-iso-(R-Bpin)Ir(Bpin)2(H).log"]
                  }
              },
              "Bis-5-CF3-Bipy": {
                  "Ir(Bpin)": ["L28-Ir(Bpin).log"],
                  "Ir(Bpin)3": ["L28-Ir(Bpin)3.log"],
                  "Ir(Bpin)5": ["L28-Ir(Bpin)5.log"],
                  "Ir(H)(Bpin)2": ["L28-Ir(H)(Bpin)2.log"],
                  "Isom-H": {
                      "RE-TS-isoH-Ir(Bpin)3(R)(H)": ["L28-RE-TS-isoH-Ir(Bpin)3(R)(H).log"],
                      "isoH-Ir(Bpin)3(R)(H)": ["L28-isoH-Ir(Bpin)3(R)(H).log"],
                      "isomH-TS-Ir(Bpin)3(R)(H)": ["L28-isomH-TS-Ir(Bpin)3(R)(H).log"],
                      "œÉ-isoH-(R-Bpin)Ir(Bpin)2(H)": ["L28-œÉ-isoH-(R-Bpin)Ir(Bpin)2(H).log"]
                  },
                  "Isom-S": {
                      "RE-TS-isoS-Ir(Bpin)3(R)(H)": ["L28-RE-TS-isoS-Ir(Bpin)3(R)(H).log"],
                      "isoS-Ir(Bpin)3(R)(H)": ["L28-isoS-Ir(Bpin)3(R)(H).log"],
                      "isomS-TS-Ir(Bpin)3(R)(H)": ["L28-isomS-TS-Ir(Bpin)3(R)(H).log"],
                      "œÉ-isoS-(R-Bpin)Ir(Bpin)2(H)": ["L28-œÉ-isoS-(R-Bpin)Ir(Bpin)2(H).log"]
                  },
                  "OA": {
                      "Ir(Bpin)3(R)(H)": ["L28-Ir(Bpin)3(R)(H).log"],
                      "OA-TS-Ir(R-H)(Bpin)3": ["L28-OA-TS-Ir(R-H)(Bpin)3.log"],
                      "œÉ-(R-H)Ir(Bpin)3": ["L28-œÉ-(R-H)Ir(Bpin)3.log"]
                  },
                  "RE": {
                      "RE-TS-Ir(Bpin)3(R)(H)": ["L28-RE-TS-Ir(Bpin)3(R)(H).log"],
                      "œÉ-iso-(R-Bpin)Ir(Bpin)2(H)": ["L28-œÉ-iso-(R-Bpin)Ir(Bpin)2(H).log"]
                  }
              }
          },
        "Borylation of 44c": {
            "5-CF3-Bipy": {
                "Isom-H": {
                    "RE-TS-isoH-Ir(Bpin)3(R)(H)": ["L27-RE-TS-isoH-Ir(Bpin)3(R)(H).log"],
                    "isoH-Ir(Bpin)3(R)(H)": ["L27-isoH-Ir(Bpin)3(R)(H).log"],
                    "isomH-TS-Ir(Bpin)3(R)(H)": ["L27-isomH-TS-Ir(Bpin)3(R)(H).log"],
                    "œÉ-isoH-(R-Bpin)Ir(Bpin)2(H)": ["L27-œÉ-isoH-(R-Bpin)Ir(Bpin)2(H).log"]
                },
                "Isom-S": {
                    "RE-TS-isoS-Ir(Bpin)3(R)(H)": ["L27-RE-TS-isoS-Ir(Bpin)3(R)(H).log"],
                    "isoS-Ir(Bpin)3(R)(H)": ["L27-isoS-Ir(Bpin)3(R)(H).log"],
                    "isomS-TS-Ir(Bpin)3(R)(H)": ["L27-isomS-TS-Ir(Bpin)3(R)(H).log"],
                    "œÉ-isoS-(R-Bpin)Ir(Bpin)2(H)": ["L27-œÉ-isoS-(R-Bpin)Ir(Bpin)2(H).log"]
                },
                "OA": {
                    "Ir(Bpin)3(R)(H)": ["L27-Ir(Bpin)3(R)(H).log"],
                    "OA-TS-Ir(R-H)(Bpin)3": ["L27-OA-TS-Ir(R-H)(Bpin)3.log"],
                    "œÉ-(R-H)Ir(Bpin)3": ["L27-œÉ-(R-H)Ir(Bpin)3.log"]
                },
                "RE": {
                    "RE-TS-Ir(Bpin)3(R)(H)": ["L27-RE-TS-Ir(Bpin)3(R)(H).log"],
                    "œÉ-iso-(R-Bpin)Ir(Bpin)2(H)": ["L27-œÉ-iso-(R-Bpin)Ir(Bpin)2(H).log"]
                }
            },
            "Bipy": {
                "Isom-H": {
                    "RE-TS-isoH-Ir(Bpin)3(R)(H)": ["Bipy-RE-TS-isoH-Ir(Bpin)3(R)(H).log"],
                    "isoH-Ir(Bpin)3(R)(H)": ["Bipy-isoH-Ir(Bpin)3(R)(H).log"],
                    "isomH-TS-Ir(Bpin)3(R)(H)": ["Bipy-isomH-TS-Ir(Bpin)3(R)(H).log"],
                    "œÉ-isoH-(R-Bpin)Ir(Bpin)2(H)": ["Bipy-œÉ-isoH-(R-Bpin)Ir(Bpin)2(H).log"]
                },
                "Isom-S": {
                    "RE-TS-isoS-Ir(Bpin)3(R)(H)": ["Bipy-RE-TS-isoS-Ir(Bpin)3(R)(H).log"],
                    "isoS-Ir(Bpin)3(R)(H)": ["Bipy-isoS-Ir(Bpin)3(R)(H).log"],
                    "isomS-TS-Ir(Bpin)3(R)(H)": ["Bipy-isomS-TS-Ir(Bpin)3(R)(H).log"],
                    "œÉ-isoS-(R-Bpin)Ir(Bpin)2(H)": ["Bipy-œÉ-isoS-(R-Bpin)Ir(Bpin)2(H).log"]
                },
                "OA": {
                    "Ir(Bpin)3(R)(H)": ["Bipy-Ir(Bpin)3(R)(H).log"],
                    "OA-TS-Ir(R-H)(Bpin)3": ["Bipy-OA-TS-Ir(R-H)(Bpin)3.log"],
                    "œÉ-(R-H)Ir(Bpin)3": ["Bipy-œÉ-(R-H)Ir(Bpin)3.log"]
                },
                "RE": {
                    "RE-TS-Ir(Bpin)3(R)(H)": ["Bipy-RE-TS-Ir(Bpin)3(R)(H).log"],
                    "œÉ-iso-(R-Bpin)Ir(Bpin)2(H)": ["Bipy-œÉ-iso-(R-Bpin)Ir(Bpin)2(H).log"]
                }
            },
            "Bis-5-CF3-Bipy": {
                "Isom-H": {
                    "RE-TS-isoH-Ir(Bpin)3(R)(H)": ["L28-RE-TS-isoH-Ir(Bpin)3(R)(H).log"],
                    "isoH-Ir(Bpin)3(R)(H)": ["L28-isoH-Ir(Bpin)3(R)(H).log"],
                    "isomH-TS-Ir(Bpin)3(R)(H)": ["L28-isomH-TS-Ir(Bpin)3(R)(H).log"],
                    "œÉ-isoH-(R-Bpin)Ir(Bpin)2(H)": ["L28-œÉ-isoH-(R-Bpin)Ir(Bpin)2(H).log"]
                },
                "Isom-S": {
                    "RE-TS-isoS-Ir(Bpin)3(R)(H)": ["L28-RE-TS-isoS-Ir(Bpin)3(R)(H).log"],
                    "isoS-Ir(Bpin)3(R)(H)": ["L28-isoS-Ir(Bpin)3(R)(H).log"],
                    "isomS-TS-Ir(Bpin)3(R)(H)": ["L28-isomS-TS-Ir(Bpin)3(R)(H).log"],
                    "œÉ-isoS-(R-Bpin)Ir(Bpin)2(H)": ["L28-œÉ-isoS-(R-Bpin)Ir(Bpin)2(H).log"]
                },
                "OA": {
                    "Ir(Bpin)3(R)(H)": ["L28-Ir(Bpin)3(R)(H).log"],
                    "OA-TS-Ir(R-H)(Bpin)3": ["L28-OA-TS-Ir(R-H)(Bpin)3.log"],
                    "œÉ-(R-H)Ir(Bpin)3": ["L28-œÉ-(R-H)Ir(Bpin)3.log"]
                },
                "RE": {
                    "RE-TS-Ir(Bpin)3(R)(H)": ["L28-RE-TS-Ir(Bpin)3(R)(H).log"],
                    "œÉ-iso-(R-Bpin)Ir(Bpin)2(H)": ["L28-œÉ-iso-(R-Bpin)Ir(Bpin)2(H).log"]
                }
            }
        },
        "Borylation of 44f": {
            "C-CH3": {
                "5-CF3-Bipy": {
                    "OA": {
                        "Ir(Bpin)3(R)(H)": ["L27-Ir(Bpin)3(R)(H).log"],
                        "OA-TS-Ir(R-H)(Bpin)3": ["L27-OA-TS-Ir(R-H)(Bpin)3.log"],
                        "œÉ-(R-H)Ir(Bpin)3": ["L27-œÉ-(R-H)Ir(Bpin)3.log"]
                    }
                },
                "Bipy": {
                    "OA": {
                        "Ir(Bpin)3(R)(H)": ["Bipy-Ir(Bpin)3(R)(H).log"],
                        "OA-TS-Ir(R-H)(Bpin)3": ["Bipy-OA-TS-Ir(R-H)(Bpin)3.log"],
                        "œÉ-(R-H)Ir(Bpin)3": ["Bipy-œÉ-(R-H)Ir(Bpin)3.log"]
                    }
                },
                "Bis-5-CF3-Bipy": {
                    "OA": {
                        "Ir(Bpin)3(R)(H)": ["L28-Ir(Bpin)3(R)(H).log"],
                        "OA-TS-Ir(R-H)(Bpin)3": ["L28-OA-TS-Ir(R-H)(Bpin)3.log"],
                        "œÉ-(R-H)Ir(Bpin)3": ["L28-œÉ-(R-H)Ir(Bpin)3.log"]
                    }
                }
            },
            "N-CH3": {
                "5-CF3-Bipy": {
                    "OA": {
                        "Ir(Bpin)3(R)(H)": ["L27-Ir(Bpin)3(R)(H).log"],
                        "OA-TS-Ir(R-H)(Bpin)3": ["L27-OA-TS-Ir(R-H)(Bpin)3.log"],
                        "œÉ-(R-H)Ir(Bpin)3": ["L27-œÉ-(R-H)Ir(Bpin)3.log"]
                    }
                },
                "Bipy": {
                    "OA": {
                        "Ir(Bpin)3(R)(H)": ["Bipy-Ir(Bpin)3(R)(H).log"],
                        "OA-TS-Ir(R-H)(Bpin)3": ["Bipy-OA-TS-Ir(R-H)(Bpin)3.log"],
                        "œÉ-(R-H)Ir(Bpin)3": ["Bipy-œÉ-(R-H)Ir(Bpin)3.log"]
                    }
                },
                "Bis-5-CF3-Bipy": {
                    "OA": {
                        "Ir(Bpin)3(R)(H)": ["L28-Ir(Bpin)3(R)(H).log"],
                        "OA-TS-Ir(R-H)(Bpin)3": ["L28-OA-TS-Ir(R-H)(Bpin)3.log"],
                        "œÉ-(R-H)Ir(Bpin)3": ["L28-œÉ-(R-H)Ir(Bpin)3.log"]
                    }
                }
            }
        },
        "Borylation of 44u": {
          "Bis-5-CF3-Bipy": {
              "OA": {
                  "Ir(Bpin)3(R)(H)": ["L28-Ir(Bpin)3(R)(H).log"],
                  "OA-TS-Ir(R-H)(Bpin)3": ["L28-OA-TS-Ir(R-H)(Bpin)3.log"],
                  "œÉ-(R-H)Ir(Bpin)3": ["L28-œÉ-(R-H)Ir(Bpin)3.log"]
              }
          }
      },
      "Rollover": {
          "Bipy": {
              "Hemilabile-TS": ["Bipy-Hemilabile-TS.log"],
              "Ir(LX)Bpin2": ["Bipy-Ir(LX)Bpin2.log"],
              "Ir-(L)-Bpin3": ["Bipy-Ir-(L)-Bpin3.log"],
              "Ligand_C-H-TS": ["Bipy-Ligand_C-H-TS.log"],
              "OA-TS-Ir(LX)(R-H)(Bpin)3": ["Bipy-OA-TS-Ir(LX)(R-H)(Bpin)3.log"]
          },
          "Bis-5-CF3-Bipy": {
              "Hemilabile-TS": ["L28-Hemilabile-TS.log"],
              "Ir(LX)(Bpin)2": ["L28-Ir(LX)(Bpin)2.log"],
              "Ir-(L)-Bpin3": ["L28-Ir-(L)-Bpin3.log"],
              "Ligand_C-H-TS": ["L28-Ligand_C-H-TS.log"],
              "OA-TS-Ir(LX)(R-H)(Bpin)3": ["L28-OA-TS-Ir(LX)(R-H)(Bpin)3.log"]
          }
        }
      }
    }
  };

    const moleculeMetadata = {
        "bipy-OA-TS-Ir(R-H)(Bpin)3": { "desc": "Oxidative addition Transition State for Bipyridine ligand. Key step in Ir-catalyzed C-H borylation.", "paper": "https://doi.org/10.1002/anie.XXXX" },
        "Bipy_TS_m-3": { "desc": "Transition state showing the meta-selective C-H activation process.", "paper": "https://doi.org/10.1021/acscatal.XXXX" }
    };

    let myJmol = null;

    // --- MEJORA: L√≥gica de Men√∫ Lateral uniforme ---
    function createSidebarMenu(data, parent, basePath = "molecules", level = 0) {
        Object.keys(data).forEach((key) => {
            const isTopLevel = (level === 0 || key.includes("section"));

            if (Array.isArray(data[key])) {
                // Es un listado de archivos
                const sectionLink = document.createElement("a");
                sectionLink.textContent = key;
                sectionLink.className = isTopLevel ? "folder-link dark" : "folder-link";
                sectionLink.onclick = () => toggleSection(`section-${basePath}-${key.replace(/\s+/g, '')}`);
                parent.appendChild(sectionLink);

                const subDiv = document.createElement("div");
                subDiv.id = `section-${basePath}-${key.replace(/\s+/g, '')}`;
                subDiv.className = "submenu";
                subDiv.style.display = "none";

                data[key].forEach((file) => {
                    const moleculeName = file.replace('.log', '');
                    const fileLink = document.createElement("a");
                    fileLink.textContent = moleculeName;
                    fileLink.className = "file-link";
                    fileLink.onclick = () => loadMolecule(`${basePath}/${key}/${file}`, moleculeName);
                    subDiv.appendChild(fileLink);
                });
                parent.appendChild(subDiv);

            } else if (typeof data[key] === "object") {
                // Es una carpeta con m√°s contenido
                const folderLink = document.createElement("a");
                folderLink.textContent = key;
                folderLink.className = isTopLevel ? "folder-link dark" : "folder-link";
                folderLink.onclick = () => toggleSection(`section-${basePath}-${key.replace(/\s+/g, '')}`);
                parent.appendChild(folderLink);

                const subfolderDiv = document.createElement("div");
                subfolderDiv.id = `section-${basePath}-${key.replace(/\s+/g, '')}`;
                subfolderDiv.className = "submenu";
                subfolderDiv.style.display = "none";
                createSidebarMenu(data[key], subfolderDiv, `${basePath}/${key}`, level + 1);
                parent.appendChild(subfolderDiv);
            }
        });
    }

    function toggleSection(id) {
        const s = document.getElementById(id);
        if (s) s.style.display = (s.style.display === "none" || s.style.display === "") ? "block" : "none";
    }

    function loadMolecule(filePath, moleculeName) {
        const content = document.getElementById("dynamic-content");
        const meta = moleculeMetadata[moleculeName] || { desc: "Optimized geometry (DFT level). Analyze coordinates and vibrational modes below.", paper: null };

        // CORRECCI√ìN: He eliminado la l√≠nea de "Source: molecules/..."
        content.innerHTML = `
            <div class="molecule-card">
                <header class="mol-header">
                    <h2>${moleculeName}</h2>
                </header>

                <div id="jsmolContainer" class="jsmol-box"></div>

                <div class="toolbar">
                    <div class="tool-group">
                        <button onclick="Jmol.script(myJmol, 'reset')">Reset View</button>
                        <button onclick="Jmol.script(myJmol, 'zoom +20')">Zoom +</button>
                        <button onclick="Jmol.script(myJmol, 'zoom -20')">Zoom -</button>
                    </div>
                    <div class="tool-group">
                        <label class="check-container"><input type="checkbox" onchange="Jmol.script(myJmol, this.checked ? 'spin on' : 'spin off')"> Spin</label>
                        <label class="check-container"><input type="checkbox" onchange="Jmol.script(myJmol, this.checked ? 'vibration on' : 'vibration off')"> Imaginary Freq.</label>
                    </div>
                    <button class="btn-save" onclick="Jmol.script(myJmol, 'write PNGJ \\'${moleculeName}.png\\'')">üì∏ Save PNG</button>
                </div>

                <div class="scientific-info">
                    <h3>Scientific Context</h3>
                    <p>${meta.desc}</p>
                    ${meta.paper ? `<a href="${meta.paper}" target="_blank" class="paper-link">Read full paper ‚Üí</a>` : ''}
                </div>
            </div>
        `;

        const Info = {
            width: "100%",
            height: 500,
            j2sPath: "j2s",
            color: "#FFFFFF",
            use: "HTML5",
            disableJ2SLoadMonitor: true,
            disableInitialConsole: true
        };

        myJmol = Jmol.getApplet("myJmol", Info);
        document.getElementById("jsmolContainer").innerHTML = Jmol.getAppletHtml(myJmol);
        Jmol.script(myJmol, `load '${filePath}'; model 2; set ambientPercent 25; set specularPower 100; set specularPercent 22; set antialiasDisplay on;`);

        setActiveLink(moleculeName);
        if (window.innerWidth <= 768) toggleSidebar();
    }

    function showHomePage() {
        const content = document.getElementById("dynamic-content");
        content.innerHTML = `
            <div class="home-hero">
                <h1>Interactive Mechanistic Viewer</h1>
                <p class="lead">A digital supplement to the doctoral thesis of Daniel Marcos Atanes. Explore computational structures and transition states in high resolution.</p>

                <div class="oracle-card">
                    <span class="label">Gaussian Oracle</span>
                    <p id="quote-display">Loading...</p>
                    <button class="btn-ghost" onclick="loadRandomQuote()">Next Quote</button>
                </div>

                <div class="guide">
                    <div class="guide-item">
                        <strong>Navigation:</strong> Use the sidebar to browse through chapters 7.1, 7.2, and 7.3.
                    </div>
                    <div class="guide-item">
                        <strong>Interaction:</strong> Rotate with your mouse, zoom with scroll, and right-click for the advanced Jmol menu.
                    </div>
                </div>
            </div>
        `;
        loadRandomQuote();
    }

    function loadRandomQuote() {
        fetch('g16_quotes.txt')
            .then(r => r.text())
            .then(text => {
                const quotes = text.split('\n\n').filter(q => q.trim() !== "");
                document.getElementById("quote-display").textContent = quotes[Math.floor(Math.random() * quotes.length)];
            })
            .catch(() => document.getElementById("quote-display").textContent = "Gaussian job finished successfully.");
    }

    function searchMenu() {
        const q = document.getElementById("sidebar-search").value.toLowerCase();
        document.querySelectorAll("#menu a").forEach(a => {
            if (!a.classList.contains('folder-link')) {
                a.style.display = a.textContent.toLowerCase().includes(q) ? "block" : "none";
            }
        });
    }

    function setActiveLink(name) {
        document.querySelectorAll('#menu a').forEach(a => {
            a.classList.remove('active');
            if (a.textContent === name) a.classList.add('active');
        });
    }

    window.onload = () => {
        createSidebarMenu(structureData.Structures, document.getElementById("menu"));
        showHomePage();
    };
</script>
</body>
</html>
