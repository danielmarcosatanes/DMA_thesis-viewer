<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>DMA Thesis: 3D Molecule Viewer</title>
    <link rel="stylesheet" href="styles.css">
    <script type="text/javascript" src="JSmol.min.js"></script>
</head>
<body>
    <!-- Main Container -->
    <div id="main-container">
        <!-- Mobile Sidebar Toggle Button -->
        <button id="sidebar-toggle" class="mobile-toggle" aria-label="Toggle sidebar" onclick="toggleSidebar()">☰</button>

        <!-- Desktop Sidebar Toggle Button -->
        <button id="collapse-btn" class="collapse-btn" aria-label="Collapse Sidebar">☰</button>

        <!-- Sidebar -->
        <div id="sidebar">
            <!-- Sidebar Header -->
            <header>
                <h2>DMA Thesis</h2>
                <input type="text" id="sidebar-search" placeholder="Search..." onkeyup="searchMenu()">
            </header>

            <!-- Sidebar Menu -->
            <div id="menu"></div>

            <!-- Sidebar Footer -->
            <footer>
                2024 DMA Thesis Viewer. All rights reserved.
            </footer>
        </div>

        <!-- Main Content Area -->
        <div id="content">
            <div id="home-page">
                <h1 style="color: #28528E;">DMA Thesis: 3D Molecule Viewer</h1>
                <p>Welcome to the DMA Thesis 3D Molecule Visualizer. This tool allows you to explore the molecular structures discussed in the thesis. Use the menu to navigate through various sections and visualize the corresponding molecules.</p>
            </div>
        </div>
    </div>

    <script>
        const structureData = {
            "Structures section 7.1": {
                files: [
                    "4-m-bipy-OA-TS-Ir(R-H)(Bpin)3.log",
                    "4-p-bipy-OA-TS-Ir(R-H)(Bpin)3.log",
                    "5-OR-bipy-OA-TS-Ir(R-H)(Bpin)3.log",
                    "5-m-phen-OA-TS-Ir(R-H)(Bpin)3.log",
                    "5-p-phen-OA-TS-Ir(R-H)(Bpin)3.log",
                    "bipy-OA-TS-Ir(R-H)(Bpin)3.log"
                ]
            },
            "Structures section 7.3": {
                folders: {
                    "44a": {
                        folders: {
                            "5-CF3-Bipy": {
                                folders: {
                                    "Ir(Bpin)": ["L27-Ir(Bpin).log"],
                                    "Ir(Bpin)3": ["L27-Ir(Bpin)3.log"]
                                }
                            }
                        }
                    }
                }
            }
        };

        function createSidebar(data, parentElement) {
            for (const [key, value] of Object.entries(data)) {
                if (value.files) {
                    const section = document.createElement("a");
                    section.textContent = key;
                    section.href = "#";
                    section.onclick = () => toggleSection(`section-${key}`);
                    parentElement.appendChild(section);

                    const subsection = document.createElement("div");
                    subsection.id = `section-${key}`;
                    subsection.style.display = "none";
                    value.files.forEach(file => {
                        const link = document.createElement("a");
                        link.textContent = file;
                        link.href = "#";
                        link.onclick = () => showMolecule(file);
                        subsection.appendChild(link);
                    });
                    parentElement.appendChild(subsection);
                } else if (value.folders) {
                    const folder = document.createElement("a");
                    folder.textContent = key;
                    folder.href = "#";
                    folder.onclick = () => toggleSection(`section-${key}`);
                    parentElement.appendChild(folder);

                    const subfolder = document.createElement("div");
                    subfolder.id = `section-${key}`;
                    subfolder.style.display = "none";
                    createSidebar(value.folders, subfolder);
                    parentElement.appendChild(subfolder);
                }
            }
        }

        function showMolecule(file) {
            const content = document.getElementById("content");
            content.innerHTML = "";

            const subsection = document.createElement("div");
            subsection.id = `subsection-${file}`;
            subsection.innerHTML = `
                <h3>${file}</h3>
                <div id="jsmolContainer-${file}" class="jsmolContainer"></div>
                <div class="button-container">
                    <button onclick="resetMolecule('jsmolContainer-${file}')">Reset</button>
                    <button onclick="zoomInMolecule('jsmolContainer-${file}')">Zoom In</button>
                    <button onclick="zoomOutMolecule('jsmolContainer-${file}')">Zoom Out</button>
                    <label>
                        <input type="checkbox" onchange="toggleSpin('jsmolContainer-${file}', this.checked)"> Spin
                    </label>
                    <label for="vibrationCheckbox">
                      <input type="checkbox" id="vibrationCheckbox"> imaginary freq.
                    </label>
                </div>
            `;
            content.appendChild(subsection);

            loadJSmol(`jsmolContainer-${file}`, file);
        }

        function loadJSmol(containerId, moleculeFile) {
            const Info = {
                width: 700,
                height: 400,
                j2sPath: "j2s",
                use: "HTML5",
                disableJ2SLoadMonitor: true,
                disableInitialConsole: true
            };
            const applet = Jmol.getApplet(containerId, Info);
            document.getElementById(containerId).innerHTML = Jmol.getAppletHtml(applet);
            Jmol.script(applet, `load 'molecules/${moleculeFile}';`);
            Jmol.script(applet, "model 2");
            Jmol.script(applet, "set ambientPercent 25; set specularPower 100; set specularPercent 22; set specularExponent 4; set cartoonsFancy on; set antialiasDisplay on; set hermiteLevel 20;");

        }

        function toggleSection(id) {
            const section = document.getElementById(id);
            section.style.display = section.style.display === "none" ? "block" : "none";
        }

        // Reset button functionality
        document.getElementById("resetBtn").onclick = function() {
            Jmol.script(applet, "reset");
            console.log("Resetting molecule");
        };

        // Zoom In button functionality
        document.getElementById("zoomInBtn").onclick = function() {
            Jmol.script(applet, "zoom +20");
            console.log("Zooming In");
        };

        // Zoom Out button functionality
        document.getElementById("zoomOutBtn").onclick = function() {
            Jmol.script(applet, "zoom -20");
            console.log("Zooming Out");
        };

        // Spin checkbox functionality
        const spinCheckbox = document.getElementById("spinCheckbox");
        spinCheckbox.addEventListener("change", function() {
            if (spinCheckbox.checked) {
                Jmol.script(applet, "spin on");
                console.log("Spin enabled");
            } else {
                Jmol.script(applet, "spin off");
                console.log("Spin disabled");
            }
        });

        // Event listener for vibration checkbox
        document.getElementById("vibrationCheckbox").addEventListener("change", function (event) {
            if (event.target.checked) {
                Jmol.script(applet, "vibration on");
            } else {
                Jmol.script(applet, "vibration off");
            }
        });


        window.onload = function () {
            const sidebarMenu = document.getElementById("menu");
            createSidebar(structureData, sidebarMenu);
        };

        // Toggle the sidebar visibility for mobile
        document.querySelector('.mobile-toggle').addEventListener('click', function() {
            document.getElementById('sidebar').classList.toggle('show');  // Toggle visibility
        });

        // Toggle the sidebar visibility for desktop
        document.querySelector('#collapse-btn').addEventListener('click', function() {
            const sidebar = document.getElementById('sidebar');
            sidebar.classList.toggle('show'); // Toggle visibility for desktop
            sidebar.classList.toggle('collapsed'); // Toggle the collapsed state for desktop
        });

    </script>
</body>
</html>
