<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>DMA Thesis: 3D Molecule Viewer</title>
    <link rel="stylesheet" href="styles.css">
    <script type="text/javascript" src="JSmol.min.js"></script>
</head>
<body>
    <!-- Main Container with Sidebar and Content -->
    <div id="main-container">
        <!-- Mobile Sidebar Toggle Button -->
        <button id="sidebar-toggle" class="mobile-toggle" aria-label="Toggle sidebar" onclick="toggleSidebar()">☰</button>
        <!-- Desktop Sidebar Toggle Button -->
        <button id="collapse-btn" class="collapse-btn" aria-label="Collapse Sidebar">☰</button>

        <!-- Sidebar -->
        <div id="sidebar">
            <!-- Sidebar header -->
            <header>
                <h2>DMA Thesis</h2>
                <input type="text" id="sidebar-search" placeholder="Search..." onkeyup="searchMenu()">
            </header>

            <!-- Menu -->
            <div id="menu">
                <a href="#" id="home-link" onclick="showHome(); setActiveLink('home-link')">Home</a>
                <a href="#" id="structures-link" onclick="toggleStructuresMenu(); setActiveLink('structures-link')">Structures</a>

                <div id="structures-menu" class="sidebar-section" style="display: none;">
                    <a href="#" onclick="showSection('section7.1'); setActiveLink('section7.1')">Structures section 7.1</a>
                    <div id="subsections7.1" class="subsections" style="display: none;">
                        <a href="#" onclick="showSubsection('subsection44aBipyIrBpin'); setActiveLink('subsection44aBipyIrBpin')">44a-Bipy-Ir(Bpin)</a>
                        <a href="#" onclick="showSubsection('subsection44aBipyIrBpin5'); setActiveLink('subsection44aBipyIrBpin5')">44a-Bipy-Ir(Bpin)5</a>
                    </div>
                    <a href="#" onclick="showSection('section7.2'); setActiveLink('section7.2')">Structures section 7.2</a>
                    <div id="subsections7.2" class="subsections" style="display: none;">
                        <a href="#" onclick="showSubsection('subsection44aBipyIrHBPin2'); setActiveLink('subsection44aBipyIrHBPin2')">44a-Bipy-Ir-H-Bpin2</a>
                    </div>
                    <a href="#" onclick="showSection('section7.3'); setActiveLink('section7.3')">Structures section 7.3</a>
                    <div id="subsections7.3" class="subsections" style="display: none;">
                        <a href="#" onclick="showSubsection('subsection44a'); setActiveLink('subsection44a')">44a</a>
                        <a href="#" onclick="showSubsection('subsection45a'); setActiveLink('subsection45a')">45a</a>
                    </div>
                </div>
            </div>

            <!-- Sidebar Footer -->
            <footer>
                2024 DMA Thesis Viewer. All rights reserved.
            </footer>
        </div>

        <!-- Main Content Area -->
        <div id="content">
            <!-- Home Page -->
            <div id="home-page" style="display: block;">
                <h1 id="home-header" style="color: #28528E;">DMA Thesis: 3D Molecule Viewer</h1>
                <p>Welcome to the DMA Thesis 3D Molecule Visualizer. This tool allows you to explore the molecular structures discussed in the thesis. Use the menu to navigate through various sections and visualize the corresponding molecules.</p>
            </div>

            <!-- Sections -->
            <div id="message" style="display: none;">Select a structure section</div>
            <div id="section7.1" style="display:none;">
                <h2>Structures section 7.1</h2>
                <p>Relevant 3D structures for section 7.1 of the discussion.</p>
            </div>
            <div id="section7.2" style="display:none;">
                <h2>Structures section 7.2</h2>
                <p>Relevant 3D structures for section 7.2 of the discussion.</p>
            </div>
            <div id="section7.3" style="display:none;">
                <h2>Structures section 7.3</h2>
                <p>Relevant 3D structures for section 7.3 of the discussion.</p>
            </div>

            <!-- Subsections -->
            <div id="subsection44aBipyIrBpin" style="display:none;">
                <h3>44a-Bipy-Ir(Bpin)</h3>
                <div id="jsmolContainer44aBipyIrBpin" class="jsmolContainer"></div>
            </div>
            <div id="subsection44aBipyIrBpin5" style="display:none;">
                <h3>44a-Bipy-Ir(Bpin)5</h3>
                <div id="jsmolContainer44aBipyIrBpin5" class="jsmolContainer"></div>
            </div>
            <div id="subsection44aBipyIrHBPin2" style="display:none;">
                <h3>44a-Bipy-Ir-H-Bpin2</h3>
                <div id="jsmolContainer44aBipyIrHBPin2" class="jsmolContainer"></div>
            </div>
            <div id="subsection44a" style="display:none;">
                <h3>44a</h3>
                <div id="jsmolContainer44a" class="jsmolContainer"></div>
            </div>
            <div id="subsection45a" style="display:none;">
                <h3>45a</h3>
                <div id="jsmolContainer45a" class="jsmolContainer"></div>
            </div>
        </div>
    </div>

    <script>
    // Load JSmol function (for molecules)
    function loadJSmol(containerId, moleculeFile) {
        const Info = {
            width: 700,
            height: 400,
            j2sPath: "j2s",
            color: "white",
            use: "HTML5",
            disableJ2SLoadMonitor: true,
            disableInitialConsole: true
        };
        const jsmolApplet = Jmol.getApplet(containerId, Info);
        document.getElementById(containerId).innerHTML = Jmol.getAppletHtml(jsmolApplet);
        Jmol.script(jsmolApplet, `load 'molecules/${moleculeFile}';`);
      }

        function showHome() {
            displayOnly('home-page');
            setActiveLink('home-link');
        }

        function toggleStructuresMenu() {
            const structuresMenu = document.getElementById('structures-menu');
            structuresMenu.style.display = structuresMenu.style.display === 'none' ? 'block' : 'none';  // Toggle structures menu
        }

        function showSection(sectionId) {
            // Hide all sections and subsections
            document.querySelectorAll('.sidebar-section').forEach(section => section.style.display = 'none');
            document.querySelectorAll('.subsections').forEach(subsection => subsection.style.display = 'none');

            // Display the selected section
            const section = document.getElementById(sectionId);
            if (section) {
                section.style.display = 'block';
            }

            // Show subsections if available
            const subsections = document.getElementById('subsections' + sectionId.split('section')[1]);
            if (subsections) {
                subsections.style.display = 'block';
            }
        }

        function showSubsection(subsectionId) {
            // Hide all subsections
            document.querySelectorAll('#content > div').forEach(subsection => subsection.style.display = 'none');

            // Display the clicked subsection
            document.getElementById(subsectionId).style.display = 'block';

            // Highlight the active link in the sidebar
            setActiveLink(subsectionId);

            // Load the corresponding molecule
            const molecules = {
                'subsection44aBipyIrBpin': '44a-Bipy-Ir(Bpin).log',
                'subsection44aBipyIrBpin5': '44a-Bipy-Ir(Bpin)5.log',
                'subsection44aBipyIrHBPin2': '44a-Bipy-Ir-H-Bpin2.log',
                'subsection44a': '44a.log',
                'subsection45a': '45a.log'
            };

            const moleculeFile = molecules[subsectionId];
            if (moleculeFile) {
                loadJSmol('jsmolContainer' + subsectionId, moleculeFile);
            }
        }

        // Function to display only the selected section
        function displayOnly(sectionId) {
            const sections = document.querySelectorAll('#content > div');
            sections.forEach(function(section) {
                section.style.display = 'none';
            });
            document.getElementById(sectionId).style.display = 'block';
        }


        function setActiveLink(linkId) {
            // Remove active class from all links
            const links = document.querySelectorAll('#menu a');
            links.forEach(link => link.classList.remove('active'));

            // Add active class to the clicked link
            const activeLink = document.getElementById(linkId);
            if (activeLink) {
                activeLink.classList.add('active');
            }
        }

        function searchMenu() {
            const query = document.getElementById('sidebar-search').value.toLowerCase();
            const links = document.querySelectorAll('#menu a'); // All sidebar links
            const sections = document.querySelectorAll('.sidebar-section'); // Top-level sections
            const subsections = document.querySelectorAll('.subsections'); // Subsections

            let hasResults = false;

            // Initially collapse all sections and subsections
            sections.forEach(section => section.style.display = 'none');
            subsections.forEach(subsection => subsection.style.display = 'none');

            // Search for matching links
            links.forEach(link => {
                if (link.textContent.toLowerCase().includes(query)) {
                    link.style.display = ''; // Show matching links
                    hasResults = true;

                    // Ensure the parent section and subsection are visible
                    const parentSubsection = link.closest('.subsections');
                    const parentSection = link.closest('.sidebar-section');

                    if (parentSubsection) {
                        parentSubsection.style.display = 'block';
                    }
                    if (parentSection) {
                        parentSection.style.display = 'block';
                    }
                } else {
                    link.style.display = 'none'; // Hide non-matching links
                }
            });

            // Optional: Show a message if no results are found
            if (!hasResults) {
                console.log('No results found');
            }
        }

        // Function to toggle the sidebar
        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            sidebar.classList.toggle('show');
        }

        function toggleSidebarDesktop() {
          const sidebar = document.getElementById('sidebar');
          const content = document.getElementById('content');

          // Toggle the collapsed state of the sidebar
          sidebar.classList.toggle('collapsed');

          // Adjust the content margin depending on the sidebar state
          if (sidebar.classList.contains('collapsed')) {
              content.style.marginLeft = '70px'; // Adjust for collapsed sidebar
          } else {
              content.style.marginLeft = '250px'; // Restore the full sidebar width
          }
        }

        // Attach event listener
        document.getElementById('collapse-btn').addEventListener('click', toggleSidebarDesktop);
        window.addEventListener('resize', resizeJmolForMobile);
        window.addEventListener('load', resizeJmolForMobile);
    </script>
</body>
</html>
